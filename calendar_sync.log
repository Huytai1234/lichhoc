2025-04-20 01:44:10,152 - INFO - app.py:45 - Flask application starting (Ext Auth, Batch Optimized, Indent Fixed)...
2025-04-20 01:44:10,262 - INFO - _internal.py:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.1.136:5001
2025-04-20 01:44:10,262 - INFO - _internal.py:97 - [33mPress CTRL+C to quit[0m
2025-04-20 01:44:10,263 - INFO - _internal.py:97 -  * Restarting with stat
2025-04-20 01:44:10,475 - INFO - app.py:45 - Flask application starting (Ext Auth, Batch Optimized, Indent Fixed)...
2025-04-20 01:44:10,490 - WARNING - _internal.py:97 -  * Debugger is active!
2025-04-20 01:44:10,499 - INFO - _internal.py:97 -  * Debugger PIN: 117-266-166
2025-04-20 01:44:15,957 - INFO - _internal.py:97 - 127.0.0.1 - - [20/Apr/2025 01:44:15] "GET / HTTP/1.1" 200 -
2025-04-20 01:44:16,592 - INFO - _internal.py:97 - 127.0.0.1 - - [20/Apr/2025 01:44:16] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-04-20 01:45:11,645 - INFO - app.py:243 - Request /sync_from_extension (Batch Optimized, Color by Subject)
2025-04-20 01:45:11,647 - DEBUG - app.py:253 - Sync Data: user='fff@st.uel.edu.vn', date='T·ª´ ng√†y 21/04/2025 ƒë·∫øn ng√†y 27/04/2025', html=Yes
2025-04-20 01:45:11,647 - INFO - app.py:259 - Processing sync for user: fff@st.uel.edu.vn
2025-04-20 01:45:11,656 - INFO - app.py:66 - Service built from token OK.
2025-04-20 01:45:11,656 - INFO - app.py:74 - Starting schedule extraction (Flexible Parsing).
2025-04-20 01:45:11,662 - INFO - app.py:85 - Parsed week: 21/04/2025 - 27/04/2025
2025-04-20 01:45:11,670 - DEBUG - app.py:99 - Headers: ['PH√íNG', 'TH·ª® 2', 'TH·ª® 3', 'TH·ª® 4', 'TH·ª® 5', 'TH·ª® 6', 'TH·ª® 7', 'CH·ª¶ NH·∫¨T']
2025-04-20 01:45:11,670 - INFO - app.py:114 - Header: RoomIdx=0, DayIndices={'TH·ª® 2': 1, 'TH·ª® 3': 2, 'TH·ª® 4': 3, 'TH·ª® 5': 4, 'TH·ª® 6': 5, 'TH·ª® 7': 6, 'CH·ª¶ NH·∫¨T': 7}
2025-04-20 01:45:11,670 - DEBUG - app.py:125 - Row 2: Room='B1.305'
2025-04-20 01:45:11,671 - DEBUG - app.py:142 - Cell(2,2), Block 1: Lines=['Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]', '12h30 -> 16h30', 'Ti·∫øt 7-10.5', 'GV:']
2025-04-20 01:45:11,671 - DEBUG - app.py:160 - Time match: Raw='12h30 -> 16h30'
2025-04-20 01:45:11,672 - DEBUG - app.py:164 - Periods regex: '7-10.5'
2025-04-20 01:45:11,672 - DEBUG - app.py:193 - Final DateTime: Start=2025-04-22T12:30:00, End=2025-04-22T16:30:00
2025-04-20 01:45:11,672 - DEBUG - app.py:199 - Prepared: Sub='Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]', P='7-10.5'
2025-04-20 01:45:11,672 - DEBUG - app.py:142 - Cell(2,4), Block 1: Lines=['Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]', '12h30 -> 16h30', 'Ti·∫øt 7-10.5', 'GV:']
2025-04-20 01:45:11,672 - DEBUG - app.py:160 - Time match: Raw='12h30 -> 16h30'
2025-04-20 01:45:11,672 - DEBUG - app.py:164 - Periods regex: '7-10.5'
2025-04-20 01:45:11,672 - DEBUG - app.py:193 - Final DateTime: Start=2025-04-24T12:30:00, End=2025-04-24T16:30:00
2025-04-20 01:45:11,672 - DEBUG - app.py:199 - Prepared: Sub='Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]', P='7-10.5'
2025-04-20 01:45:11,673 - INFO - app.py:205 - Extraction done. Found 2 events.
2025-04-20 01:45:11,673 - DEBUG - app.py:206 - --- Final Extracted Schedule List (No Color) ---
[{'date': '22/04/2025',
  'day_name': 'TH·ª® 3',
  'description_extra': '',
  'end_datetime': '2025-04-22T16:30:00',
  'location': '',
  'periods': '7-10.5',
  'room': 'B1.305',
  'start_datetime': '2025-04-22T12:30:00',
  'subject': 'Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]',
  'teacher': '',
  'time_range': '12h30 -> 16h30'},
 {'date': '24/04/2025',
  'day_name': 'TH·ª® 5',
  'description_extra': '',
  'end_datetime': '2025-04-24T16:30:00',
  'location': '',
  'periods': '7-10.5',
  'room': 'B1.305',
  'start_datetime': '2025-04-24T12:30:00',
  'subject': 'Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]',
  'teacher': '',
  'time_range': '12h30 -> 16h30'}]
--- End List ---
2025-04-20 01:45:11,673 - INFO - app.py:273 - Extracted 2 events for 21/04/2025-27/04/2025
2025-04-20 01:45:11,673 - INFO - app.py:295 - Fetching existing events: 2025-04-20T17:00:00Z to 2025-04-27T16:59:59Z
2025-04-20 01:45:11,678 - DEBUG - discovery.py:1256 - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/primary/events?timeMin=2025-04-20T17%3A00%3A00Z&timeMax=2025-04-27T16%3A59%3A59Z&singleEvents=true&maxResults=250&alt=json
2025-04-20 01:45:12,241 - INFO - app.py:310 - Found 0 existing events details in Google Calendar for the week.
2025-04-20 01:45:12,241 - INFO - app.py:326 - Processing 2 extracted events against 0 existing ones...
2025-04-20 01:45:12,241 - DEBUG - app.py:336 - Event 1 ('Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]' Color: 1) marked for BATCH insert.
2025-04-20 01:45:12,247 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:12,248 - DEBUG - app.py:336 - Event 2 ('Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]' Color: 2) marked for BATCH insert.
2025-04-20 01:45:12,253 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:12,253 - INFO - app.py:346 - Executing batch request to insert 2 events...
2025-04-20 01:45:12,966 - INFO - app.py:235 - Batch request item event-1-Qu·∫£n tr·ªã t succeeded. Event ID: d89d93iobef57809augoo23gcg
2025-04-20 01:45:12,967 - INFO - app.py:235 - Batch request item event-2-Kinh doanh succeeded. Event ID: k2o09bfelatppsqub8o67por10
2025-04-20 01:45:12,967 - INFO - app.py:351 - Batch executed. Callback results: Added=2, Errors=0
2025-04-20 01:45:12,967 - INFO - app.py:362 - Sync done: user=fff@st.uel.edu.vn, week=21/04/2025-27/04/2025, Added=2, Skipped=0, Errors=0, Time=1.32s
2025-04-20 01:45:12,968 - INFO - _internal.py:97 - 127.0.0.1 - - [20/Apr/2025 01:45:12] "POST /sync_from_extension HTTP/1.1" 200 -
2025-04-20 01:45:13,982 - INFO - app.py:243 - Request /sync_from_extension (Batch Optimized, Color by Subject)
2025-04-20 01:45:13,982 - DEBUG - app.py:253 - Sync Data: user='fff@st.uel.edu.vn', date='T·ª´ ng√†y 28/04/2025 ƒë·∫øn ng√†y 04/05/2025', html=Yes
2025-04-20 01:45:13,982 - INFO - app.py:259 - Processing sync for user: fff@st.uel.edu.vn
2025-04-20 01:45:13,986 - INFO - app.py:66 - Service built from token OK.
2025-04-20 01:45:13,986 - INFO - app.py:74 - Starting schedule extraction (Flexible Parsing).
2025-04-20 01:45:13,986 - INFO - app.py:85 - Parsed week: 28/04/2025 - 04/05/2025
2025-04-20 01:45:13,988 - DEBUG - app.py:99 - Headers: ['PH√íNG', 'TH·ª® 2', 'TH·ª® 3', 'TH·ª® 4', 'TH·ª® 5', 'TH·ª® 6', 'TH·ª® 7', 'CH·ª¶ NH·∫¨T']
2025-04-20 01:45:13,988 - INFO - app.py:114 - Header: RoomIdx=0, DayIndices={'TH·ª® 2': 1, 'TH·ª® 3': 2, 'TH·ª® 4': 3, 'TH·ª® 5': 4, 'TH·ª® 6': 5, 'TH·ª® 7': 6, 'CH·ª¶ NH·∫¨T': 7}
2025-04-20 01:45:13,988 - DEBUG - app.py:125 - Row 2: Room='B1.305'
2025-04-20 01:45:13,988 - DEBUG - app.py:142 - Cell(2,2), Block 1: Lines=['Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]', '12h30 -> 16h30', 'Ti·∫øt 7-10.5', 'GV:']
2025-04-20 01:45:13,988 - DEBUG - app.py:160 - Time match: Raw='12h30 -> 16h30'
2025-04-20 01:45:13,988 - DEBUG - app.py:164 - Periods regex: '7-10.5'
2025-04-20 01:45:13,988 - DEBUG - app.py:193 - Final DateTime: Start=2025-04-29T12:30:00, End=2025-04-29T16:30:00
2025-04-20 01:45:13,988 - DEBUG - app.py:199 - Prepared: Sub='Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]', P='7-10.5'
2025-04-20 01:45:13,988 - INFO - app.py:205 - Extraction done. Found 1 events.
2025-04-20 01:45:13,989 - DEBUG - app.py:206 - --- Final Extracted Schedule List (No Color) ---
[{'date': '29/04/2025',
  'day_name': 'TH·ª® 3',
  'description_extra': '',
  'end_datetime': '2025-04-29T16:30:00',
  'location': '',
  'periods': '7-10.5',
  'room': 'B1.305',
  'start_datetime': '2025-04-29T12:30:00',
  'subject': 'Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]',
  'teacher': '',
  'time_range': '12h30 -> 16h30'}]
--- End List ---
2025-04-20 01:45:13,989 - INFO - app.py:273 - Extracted 1 events for 28/04/2025-04/05/2025
2025-04-20 01:45:13,989 - INFO - app.py:295 - Fetching existing events: 2025-04-27T17:00:00Z to 2025-05-04T16:59:59Z
2025-04-20 01:45:13,994 - DEBUG - discovery.py:1256 - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/primary/events?timeMin=2025-04-27T17%3A00%3A00Z&timeMax=2025-05-04T16%3A59%3A59Z&singleEvents=true&maxResults=250&alt=json
2025-04-20 01:45:14,502 - INFO - app.py:310 - Found 0 existing events details in Google Calendar for the week.
2025-04-20 01:45:14,503 - INFO - app.py:326 - Processing 1 extracted events against 0 existing ones...
2025-04-20 01:45:14,503 - DEBUG - app.py:336 - Event 1 ('Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]' Color: 1) marked for BATCH insert.
2025-04-20 01:45:14,509 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:14,510 - INFO - app.py:346 - Executing batch request to insert 1 events...
2025-04-20 01:45:15,098 - INFO - app.py:235 - Batch request item event-1-Qu·∫£n tr·ªã t succeeded. Event ID: 3hk3d54motb7b694pf6p666v4g
2025-04-20 01:45:15,099 - INFO - app.py:351 - Batch executed. Callback results: Added=1, Errors=0
2025-04-20 01:45:15,099 - INFO - app.py:362 - Sync done: user=fff@st.uel.edu.vn, week=28/04/2025-04/05/2025, Added=1, Skipped=0, Errors=0, Time=1.12s
2025-04-20 01:45:15,100 - INFO - _internal.py:97 - 127.0.0.1 - - [20/Apr/2025 01:45:15] "POST /sync_from_extension HTTP/1.1" 200 -
2025-04-20 01:45:16,121 - INFO - app.py:243 - Request /sync_from_extension (Batch Optimized, Color by Subject)
2025-04-20 01:45:16,121 - DEBUG - app.py:253 - Sync Data: user='fff@st.uel.edu.vn', date='T·ª´ ng√†y 05/05/2025 ƒë·∫øn ng√†y 11/05/2025', html=Yes
2025-04-20 01:45:16,121 - INFO - app.py:259 - Processing sync for user: fff@st.uel.edu.vn
2025-04-20 01:45:16,123 - INFO - app.py:66 - Service built from token OK.
2025-04-20 01:45:16,123 - INFO - app.py:74 - Starting schedule extraction (Flexible Parsing).
2025-04-20 01:45:16,124 - INFO - app.py:85 - Parsed week: 05/05/2025 - 11/05/2025
2025-04-20 01:45:16,125 - DEBUG - app.py:99 - Headers: ['PH√íNG', 'TH·ª® 2', 'TH·ª® 3', 'TH·ª® 4', 'TH·ª® 5', 'TH·ª® 6', 'TH·ª® 7', 'CH·ª¶ NH·∫¨T']
2025-04-20 01:45:16,125 - INFO - app.py:114 - Header: RoomIdx=0, DayIndices={'TH·ª® 2': 1, 'TH·ª® 3': 2, 'TH·ª® 4': 3, 'TH·ª® 5': 4, 'TH·ª® 6': 5, 'TH·ª® 7': 6, 'CH·ª¶ NH·∫¨T': 7}
2025-04-20 01:45:16,125 - DEBUG - app.py:125 - Row 2: Room='B1.305'
2025-04-20 01:45:16,126 - DEBUG - app.py:142 - Cell(2,2), Block 1: Lines=['K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', '7h00 -> 9h30', 'Ti·∫øt 1-3', 'GV:']
2025-04-20 01:45:16,126 - DEBUG - app.py:160 - Time match: Raw='7h00 -> 9h30'
2025-04-20 01:45:16,126 - DEBUG - app.py:164 - Periods regex: '1-3'
2025-04-20 01:45:16,126 - DEBUG - app.py:193 - Final DateTime: Start=2025-05-06T07:00:00, End=2025-05-06T09:30:00
2025-04-20 01:45:16,126 - DEBUG - app.py:199 - Prepared: Sub='K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', P='1-3'
2025-04-20 01:45:16,129 - DEBUG - app.py:142 - Cell(2,2), Block 2: Lines=['Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]', '12h30 -> 16h30', 'Ti·∫øt 7-10.5', 'GV:']
2025-04-20 01:45:16,129 - DEBUG - app.py:160 - Time match: Raw='12h30 -> 16h30'
2025-04-20 01:45:16,129 - DEBUG - app.py:164 - Periods regex: '7-10.5'
2025-04-20 01:45:16,129 - DEBUG - app.py:193 - Final DateTime: Start=2025-05-06T12:30:00, End=2025-05-06T16:30:00
2025-04-20 01:45:16,129 - DEBUG - app.py:199 - Prepared: Sub='Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]', P='7-10.5'
2025-04-20 01:45:16,130 - DEBUG - app.py:142 - Cell(2,3), Block 1: Lines=['K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', '7h00 -> 9h30', 'Ti·∫øt 1-3', 'GV:']
2025-04-20 01:45:16,130 - DEBUG - app.py:160 - Time match: Raw='7h00 -> 9h30'
2025-04-20 01:45:16,130 - DEBUG - app.py:164 - Periods regex: '1-3'
2025-04-20 01:45:16,130 - DEBUG - app.py:193 - Final DateTime: Start=2025-05-07T07:00:00, End=2025-05-07T09:30:00
2025-04-20 01:45:16,130 - DEBUG - app.py:199 - Prepared: Sub='K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', P='1-3'
2025-04-20 01:45:16,131 - DEBUG - app.py:142 - Cell(2,3), Block 2: Lines=['K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', '9h45 -> 12h15', 'Ti·∫øt 4-6', 'GV:']
2025-04-20 01:45:16,131 - DEBUG - app.py:160 - Time match: Raw='9h45 -> 12h15'
2025-04-20 01:45:16,131 - DEBUG - app.py:164 - Periods regex: '4-6'
2025-04-20 01:45:16,131 - DEBUG - app.py:193 - Final DateTime: Start=2025-05-07T09:45:00, End=2025-05-07T12:15:00
2025-04-20 01:45:16,131 - DEBUG - app.py:199 - Prepared: Sub='K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', P='4-6'
2025-04-20 01:45:16,131 - DEBUG - app.py:142 - Cell(2,4), Block 1: Lines=['K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', '7h00 -> 9h30', 'Ti·∫øt 1-3', 'GV:']
2025-04-20 01:45:16,131 - DEBUG - app.py:160 - Time match: Raw='7h00 -> 9h30'
2025-04-20 01:45:16,131 - DEBUG - app.py:164 - Periods regex: '1-3'
2025-04-20 01:45:16,131 - DEBUG - app.py:193 - Final DateTime: Start=2025-05-08T07:00:00, End=2025-05-08T09:30:00
2025-04-20 01:45:16,131 - DEBUG - app.py:199 - Prepared: Sub='K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', P='1-3'
2025-04-20 01:45:16,132 - DEBUG - app.py:142 - Cell(2,4), Block 2: Lines=['Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]', '12h30 -> 16h30', 'Ti·∫øt 7-10.5', 'GV:']
2025-04-20 01:45:16,132 - DEBUG - app.py:160 - Time match: Raw='12h30 -> 16h30'
2025-04-20 01:45:16,132 - DEBUG - app.py:164 - Periods regex: '7-10.5'
2025-04-20 01:45:16,132 - DEBUG - app.py:193 - Final DateTime: Start=2025-05-08T12:30:00, End=2025-05-08T16:30:00
2025-04-20 01:45:16,132 - DEBUG - app.py:199 - Prepared: Sub='Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]', P='7-10.5'
2025-04-20 01:45:16,132 - INFO - app.py:205 - Extraction done. Found 6 events.
2025-04-20 01:45:16,133 - DEBUG - app.py:206 - --- Final Extracted Schedule List (No Color) ---
[{'date': '06/05/2025',
  'day_name': 'TH·ª® 3',
  'description_extra': '',
  'end_datetime': '2025-05-06T09:30:00',
  'location': '',
  'periods': '1-3',
  'room': 'B1.305',
  'start_datetime': '2025-05-06T07:00:00',
  'subject': 'K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]',
  'teacher': '',
  'time_range': '7h00 -> 9h30'},
 {'date': '06/05/2025',
  'day_name': 'TH·ª® 3',
  'description_extra': '',
  'end_datetime': '2025-05-06T16:30:00',
  'location': '',
  'periods': '7-10.5',
  'room': 'B1.305',
  'start_datetime': '2025-05-06T12:30:00',
  'subject': 'Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]',
  'teacher': '',
  'time_range': '12h30 -> 16h30'},
 {'date': '07/05/2025',
  'day_name': 'TH·ª® 4',
  'description_extra': '',
  'end_datetime': '2025-05-07T09:30:00',
  'location': '',
  'periods': '1-3',
  'room': 'B1.305',
  'start_datetime': '2025-05-07T07:00:00',
  'subject': 'K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]',
  'teacher': '',
  'time_range': '7h00 -> 9h30'},
 {'date': '07/05/2025',
  'day_name': 'TH·ª® 4',
  'description_extra': '',
  'end_datetime': '2025-05-07T12:15:00',
  'location': '',
  'periods': '4-6',
  'room': 'B1.305',
  'start_datetime': '2025-05-07T09:45:00',
  'subject': 'K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]',
  'teacher': '',
  'time_range': '9h45 -> 12h15'},
 {'date': '08/05/2025',
  'day_name': 'TH·ª® 5',
  'description_extra': '',
  'end_datetime': '2025-05-08T09:30:00',
  'location': '',
  'periods': '1-3',
  'room': 'B1.305',
  'start_datetime': '2025-05-08T07:00:00',
  'subject': 'K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]',
  'teacher': '',
  'time_range': '7h00 -> 9h30'},
 {'date': '08/05/2025',
  'day_name': 'TH·ª® 5',
  'description_extra': '',
  'end_datetime': '2025-05-08T16:30:00',
  'location': '',
  'periods': '7-10.5',
  'room': 'B1.305',
  'start_datetime': '2025-05-08T12:30:00',
  'subject': 'Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]',
  'teacher': '',
  'time_range': '12h30 -> 16h30'}]
--- End List ---
2025-04-20 01:45:16,133 - INFO - app.py:273 - Extracted 6 events for 05/05/2025-11/05/2025
2025-04-20 01:45:16,133 - INFO - app.py:295 - Fetching existing events: 2025-05-04T17:00:00Z to 2025-05-11T16:59:59Z
2025-04-20 01:45:16,140 - DEBUG - discovery.py:1256 - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/primary/events?timeMin=2025-05-04T17%3A00%3A00Z&timeMax=2025-05-11T16%3A59%3A59Z&singleEvents=true&maxResults=250&alt=json
2025-04-20 01:45:16,634 - INFO - app.py:310 - Found 0 existing events details in Google Calendar for the week.
2025-04-20 01:45:16,634 - INFO - app.py:326 - Processing 6 extracted events against 0 existing ones...
2025-04-20 01:45:16,634 - DEBUG - app.py:336 - Event 1 ('K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]' Color: 1) marked for BATCH insert.
2025-04-20 01:45:16,642 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:16,642 - DEBUG - app.py:336 - Event 2 ('Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]' Color: 2) marked for BATCH insert.
2025-04-20 01:45:16,647 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:16,647 - DEBUG - app.py:336 - Event 3 ('K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]' Color: 1) marked for BATCH insert.
2025-04-20 01:45:16,651 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:16,651 - DEBUG - app.py:336 - Event 4 ('K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]' Color: 1) marked for BATCH insert.
2025-04-20 01:45:16,655 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:16,655 - DEBUG - app.py:336 - Event 5 ('K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]' Color: 1) marked for BATCH insert.
2025-04-20 01:45:16,659 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:16,659 - DEBUG - app.py:336 - Event 6 ('Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]' Color: 3) marked for BATCH insert.
2025-04-20 01:45:16,663 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:16,663 - INFO - app.py:346 - Executing batch request to insert 6 events...
2025-04-20 01:45:17,491 - INFO - app.py:235 - Batch request item event-1-K·∫ø to√°n t√† succeeded. Event ID: m4ggvu7vn07lvbflekir1u311s
2025-04-20 01:45:17,492 - INFO - app.py:235 - Batch request item event-2-Qu·∫£n tr·ªã t succeeded. Event ID: 6rkch31mffktsrsdqn095jbn7o
2025-04-20 01:45:17,492 - INFO - app.py:235 - Batch request item event-3-K·∫ø to√°n t√† succeeded. Event ID: 8sfefjn8k2h1fum1t27d576etg
2025-04-20 01:45:17,492 - INFO - app.py:235 - Batch request item event-4-K·∫ø to√°n t√† succeeded. Event ID: ck7cm7stbfkqlifu092lq7h958
2025-04-20 01:45:17,492 - INFO - app.py:235 - Batch request item event-5-K·∫ø to√°n t√† succeeded. Event ID: iafdroi1fvt5iah2cq4ftr2b08
2025-04-20 01:45:17,492 - INFO - app.py:235 - Batch request item event-6-Kinh doanh succeeded. Event ID: nsm727abr5iqt1nk39l18efg9s
2025-04-20 01:45:17,492 - INFO - app.py:351 - Batch executed. Callback results: Added=6, Errors=0
2025-04-20 01:45:17,492 - INFO - app.py:362 - Sync done: user=fff@st.uel.edu.vn, week=05/05/2025-11/05/2025, Added=6, Skipped=0, Errors=0, Time=1.37s
2025-04-20 01:45:17,493 - INFO - _internal.py:97 - 127.0.0.1 - - [20/Apr/2025 01:45:17] "POST /sync_from_extension HTTP/1.1" 200 -
2025-04-20 01:45:18,510 - INFO - app.py:243 - Request /sync_from_extension (Batch Optimized, Color by Subject)
2025-04-20 01:45:18,511 - DEBUG - app.py:253 - Sync Data: user='fff@st.uel.edu.vn', date='T·ª´ ng√†y 12/05/2025 ƒë·∫øn ng√†y 18/05/2025', html=Yes
2025-04-20 01:45:18,511 - INFO - app.py:259 - Processing sync for user: fff@st.uel.edu.vn
2025-04-20 01:45:18,512 - INFO - app.py:66 - Service built from token OK.
2025-04-20 01:45:18,512 - INFO - app.py:74 - Starting schedule extraction (Flexible Parsing).
2025-04-20 01:45:18,513 - INFO - app.py:85 - Parsed week: 12/05/2025 - 18/05/2025
2025-04-20 01:45:18,514 - DEBUG - app.py:99 - Headers: ['PH√íNG', 'TH·ª® 2', 'TH·ª® 3', 'TH·ª® 4', 'TH·ª® 5', 'TH·ª® 6', 'TH·ª® 7', 'CH·ª¶ NH·∫¨T']
2025-04-20 01:45:18,514 - INFO - app.py:114 - Header: RoomIdx=0, DayIndices={'TH·ª® 2': 1, 'TH·ª® 3': 2, 'TH·ª® 4': 3, 'TH·ª® 5': 4, 'TH·ª® 6': 5, 'TH·ª® 7': 6, 'CH·ª¶ NH·∫¨T': 7}
2025-04-20 01:45:18,514 - DEBUG - app.py:125 - Row 2: Room='B1.305'
2025-04-20 01:45:18,515 - DEBUG - app.py:142 - Cell(2,2), Block 1: Lines=['K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', '7h00 -> 9h30', 'Ti·∫øt 1-3', 'GV:']
2025-04-20 01:45:18,515 - DEBUG - app.py:160 - Time match: Raw='7h00 -> 9h30'
2025-04-20 01:45:18,515 - DEBUG - app.py:164 - Periods regex: '1-3'
2025-04-20 01:45:18,515 - DEBUG - app.py:193 - Final DateTime: Start=2025-05-13T07:00:00, End=2025-05-13T09:30:00
2025-04-20 01:45:18,515 - DEBUG - app.py:199 - Prepared: Sub='K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', P='1-3'
2025-04-20 01:45:18,515 - DEBUG - app.py:142 - Cell(2,2), Block 2: Lines=['Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]', '12h30 -> 16h30', 'Ti·∫øt 7-10.5', 'GV:']
2025-04-20 01:45:18,516 - DEBUG - app.py:160 - Time match: Raw='12h30 -> 16h30'
2025-04-20 01:45:18,516 - DEBUG - app.py:164 - Periods regex: '7-10.5'
2025-04-20 01:45:18,516 - DEBUG - app.py:193 - Final DateTime: Start=2025-05-13T12:30:00, End=2025-05-13T16:30:00
2025-04-20 01:45:18,516 - DEBUG - app.py:199 - Prepared: Sub='Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]', P='7-10.5'
2025-04-20 01:45:18,516 - DEBUG - app.py:142 - Cell(2,3), Block 1: Lines=['K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', '7h00 -> 9h30', 'Ti·∫øt 1-3', 'GV:']
2025-04-20 01:45:18,516 - DEBUG - app.py:160 - Time match: Raw='7h00 -> 9h30'
2025-04-20 01:45:18,516 - DEBUG - app.py:164 - Periods regex: '1-3'
2025-04-20 01:45:18,516 - DEBUG - app.py:193 - Final DateTime: Start=2025-05-14T07:00:00, End=2025-05-14T09:30:00
2025-04-20 01:45:18,516 - DEBUG - app.py:199 - Prepared: Sub='K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', P='1-3'
2025-04-20 01:45:18,517 - DEBUG - app.py:142 - Cell(2,4), Block 1: Lines=['K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', '7h00 -> 9h30', 'Ti·∫øt 1-3', 'GV:']
2025-04-20 01:45:18,517 - DEBUG - app.py:160 - Time match: Raw='7h00 -> 9h30'
2025-04-20 01:45:18,517 - DEBUG - app.py:164 - Periods regex: '1-3'
2025-04-20 01:45:18,517 - DEBUG - app.py:193 - Final DateTime: Start=2025-05-15T07:00:00, End=2025-05-15T09:30:00
2025-04-20 01:45:18,517 - DEBUG - app.py:199 - Prepared: Sub='K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', P='1-3'
2025-04-20 01:45:18,517 - DEBUG - app.py:142 - Cell(2,4), Block 2: Lines=['Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]', '12h30 -> 16h30', 'Ti·∫øt 7-10.5', 'GV:']
2025-04-20 01:45:18,517 - DEBUG - app.py:160 - Time match: Raw='12h30 -> 16h30'
2025-04-20 01:45:18,517 - DEBUG - app.py:164 - Periods regex: '7-10.5'
2025-04-20 01:45:18,517 - DEBUG - app.py:193 - Final DateTime: Start=2025-05-15T12:30:00, End=2025-05-15T16:30:00
2025-04-20 01:45:18,517 - DEBUG - app.py:199 - Prepared: Sub='Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]', P='7-10.5'
2025-04-20 01:45:18,518 - INFO - app.py:205 - Extraction done. Found 5 events.
2025-04-20 01:45:18,518 - DEBUG - app.py:206 - --- Final Extracted Schedule List (No Color) ---
[{'date': '13/05/2025',
  'day_name': 'TH·ª® 3',
  'description_extra': '',
  'end_datetime': '2025-05-13T09:30:00',
  'location': '',
  'periods': '1-3',
  'room': 'B1.305',
  'start_datetime': '2025-05-13T07:00:00',
  'subject': 'K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]',
  'teacher': '',
  'time_range': '7h00 -> 9h30'},
 {'date': '13/05/2025',
  'day_name': 'TH·ª® 3',
  'description_extra': '',
  'end_datetime': '2025-05-13T16:30:00',
  'location': '',
  'periods': '7-10.5',
  'room': 'B1.305',
  'start_datetime': '2025-05-13T12:30:00',
  'subject': 'Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]',
  'teacher': '',
  'time_range': '12h30 -> 16h30'},
 {'date': '14/05/2025',
  'day_name': 'TH·ª® 4',
  'description_extra': '',
  'end_datetime': '2025-05-14T09:30:00',
  'location': '',
  'periods': '1-3',
  'room': 'B1.305',
  'start_datetime': '2025-05-14T07:00:00',
  'subject': 'K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]',
  'teacher': '',
  'time_range': '7h00 -> 9h30'},
 {'date': '15/05/2025',
  'day_name': 'TH·ª® 5',
  'description_extra': '',
  'end_datetime': '2025-05-15T09:30:00',
  'location': '',
  'periods': '1-3',
  'room': 'B1.305',
  'start_datetime': '2025-05-15T07:00:00',
  'subject': 'K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]',
  'teacher': '',
  'time_range': '7h00 -> 9h30'},
 {'date': '15/05/2025',
  'day_name': 'TH·ª® 5',
  'description_extra': '',
  'end_datetime': '2025-05-15T16:30:00',
  'location': '',
  'periods': '7-10.5',
  'room': 'B1.305',
  'start_datetime': '2025-05-15T12:30:00',
  'subject': 'Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]',
  'teacher': '',
  'time_range': '12h30 -> 16h30'}]
--- End List ---
2025-04-20 01:45:18,518 - INFO - app.py:273 - Extracted 5 events for 12/05/2025-18/05/2025
2025-04-20 01:45:18,518 - INFO - app.py:295 - Fetching existing events: 2025-05-11T17:00:00Z to 2025-05-18T16:59:59Z
2025-04-20 01:45:18,524 - DEBUG - discovery.py:1256 - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/primary/events?timeMin=2025-05-11T17%3A00%3A00Z&timeMax=2025-05-18T16%3A59%3A59Z&singleEvents=true&maxResults=250&alt=json
2025-04-20 01:45:19,068 - INFO - app.py:310 - Found 0 existing events details in Google Calendar for the week.
2025-04-20 01:45:19,068 - INFO - app.py:326 - Processing 5 extracted events against 0 existing ones...
2025-04-20 01:45:19,068 - DEBUG - app.py:336 - Event 1 ('K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]' Color: 1) marked for BATCH insert.
2025-04-20 01:45:19,083 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:19,083 - DEBUG - app.py:336 - Event 2 ('Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]' Color: 2) marked for BATCH insert.
2025-04-20 01:45:19,088 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:19,088 - DEBUG - app.py:336 - Event 3 ('K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]' Color: 1) marked for BATCH insert.
2025-04-20 01:45:19,092 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:19,092 - DEBUG - app.py:336 - Event 4 ('K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]' Color: 1) marked for BATCH insert.
2025-04-20 01:45:19,095 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:19,095 - DEBUG - app.py:336 - Event 5 ('Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]' Color: 3) marked for BATCH insert.
2025-04-20 01:45:19,097 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:19,097 - INFO - app.py:346 - Executing batch request to insert 5 events...
2025-04-20 01:45:19,880 - INFO - app.py:235 - Batch request item event-1-K·∫ø to√°n t√† succeeded. Event ID: 2o00hb86gu5dd4i9drpdr59mj0
2025-04-20 01:45:19,880 - INFO - app.py:235 - Batch request item event-2-Qu·∫£n tr·ªã t succeeded. Event ID: o7jl7rps3r0f234avpiahsppic
2025-04-20 01:45:19,880 - INFO - app.py:235 - Batch request item event-3-K·∫ø to√°n t√† succeeded. Event ID: rc2bplhnikobnqf9gk82c7tf84
2025-04-20 01:45:19,881 - INFO - app.py:235 - Batch request item event-4-K·∫ø to√°n t√† succeeded. Event ID: lq7c73hng3i33b6o58de4q9oog
2025-04-20 01:45:19,881 - INFO - app.py:235 - Batch request item event-5-Kinh doanh succeeded. Event ID: 8judhavece1fsgofplf0h6hhoo
2025-04-20 01:45:19,881 - INFO - app.py:351 - Batch executed. Callback results: Added=5, Errors=0
2025-04-20 01:45:19,881 - INFO - app.py:362 - Sync done: user=fff@st.uel.edu.vn, week=12/05/2025-18/05/2025, Added=5, Skipped=0, Errors=0, Time=1.37s
2025-04-20 01:45:19,882 - INFO - _internal.py:97 - 127.0.0.1 - - [20/Apr/2025 01:45:19] "POST /sync_from_extension HTTP/1.1" 200 -
2025-04-20 01:45:20,899 - INFO - app.py:243 - Request /sync_from_extension (Batch Optimized, Color by Subject)
2025-04-20 01:45:20,900 - DEBUG - app.py:253 - Sync Data: user='fff@st.uel.edu.vn', date='T·ª´ ng√†y 19/05/2025 ƒë·∫øn ng√†y 25/05/2025', html=Yes
2025-04-20 01:45:20,900 - INFO - app.py:259 - Processing sync for user: fff@st.uel.edu.vn
2025-04-20 01:45:20,902 - INFO - app.py:66 - Service built from token OK.
2025-04-20 01:45:20,902 - INFO - app.py:74 - Starting schedule extraction (Flexible Parsing).
2025-04-20 01:45:20,902 - INFO - app.py:85 - Parsed week: 19/05/2025 - 25/05/2025
2025-04-20 01:45:20,903 - DEBUG - app.py:99 - Headers: ['PH√íNG', 'TH·ª® 2', 'TH·ª® 3', 'TH·ª® 4', 'TH·ª® 5', 'TH·ª® 6', 'TH·ª® 7', 'CH·ª¶ NH·∫¨T']
2025-04-20 01:45:20,903 - INFO - app.py:114 - Header: RoomIdx=0, DayIndices={'TH·ª® 2': 1, 'TH·ª® 3': 2, 'TH·ª® 4': 3, 'TH·ª® 5': 4, 'TH·ª® 6': 5, 'TH·ª® 7': 6, 'CH·ª¶ NH·∫¨T': 7}
2025-04-20 01:45:20,904 - DEBUG - app.py:125 - Row 2: Room='B1.305'
2025-04-20 01:45:20,905 - DEBUG - app.py:142 - Cell(2,2), Block 1: Lines=['K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', '7h00 -> 9h30', 'Ti·∫øt 1-3', 'GV:']
2025-04-20 01:45:20,905 - DEBUG - app.py:160 - Time match: Raw='7h00 -> 9h30'
2025-04-20 01:45:20,905 - DEBUG - app.py:164 - Periods regex: '1-3'
2025-04-20 01:45:20,905 - DEBUG - app.py:193 - Final DateTime: Start=2025-05-20T07:00:00, End=2025-05-20T09:30:00
2025-04-20 01:45:20,905 - DEBUG - app.py:199 - Prepared: Sub='K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', P='1-3'
2025-04-20 01:45:20,905 - DEBUG - app.py:142 - Cell(2,2), Block 2: Lines=['Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]', '12h30 -> 16h30', 'Ti·∫øt 7-10.5', 'GV:']
2025-04-20 01:45:20,905 - DEBUG - app.py:160 - Time match: Raw='12h30 -> 16h30'
2025-04-20 01:45:20,905 - DEBUG - app.py:164 - Periods regex: '7-10.5'
2025-04-20 01:45:20,905 - DEBUG - app.py:193 - Final DateTime: Start=2025-05-20T12:30:00, End=2025-05-20T16:30:00
2025-04-20 01:45:20,905 - DEBUG - app.py:199 - Prepared: Sub='Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]', P='7-10.5'
2025-04-20 01:45:20,906 - DEBUG - app.py:142 - Cell(2,4), Block 1: Lines=['K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', '7h00 -> 9h30', 'Ti·∫øt 1-3', 'GV:']
2025-04-20 01:45:20,906 - DEBUG - app.py:160 - Time match: Raw='7h00 -> 9h30'
2025-04-20 01:45:20,906 - DEBUG - app.py:164 - Periods regex: '1-3'
2025-04-20 01:45:20,906 - DEBUG - app.py:193 - Final DateTime: Start=2025-05-22T07:00:00, End=2025-05-22T09:30:00
2025-04-20 01:45:20,906 - DEBUG - app.py:199 - Prepared: Sub='K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', P='1-3'
2025-04-20 01:45:20,906 - DEBUG - app.py:142 - Cell(2,4), Block 2: Lines=['Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]', '12h30 -> 16h30', 'Ti·∫øt 7-10.5', 'GV:']
2025-04-20 01:45:20,906 - DEBUG - app.py:160 - Time match: Raw='12h30 -> 16h30'
2025-04-20 01:45:20,906 - DEBUG - app.py:164 - Periods regex: '7-10.5'
2025-04-20 01:45:20,906 - DEBUG - app.py:193 - Final DateTime: Start=2025-05-22T12:30:00, End=2025-05-22T16:30:00
2025-04-20 01:45:20,907 - DEBUG - app.py:199 - Prepared: Sub='Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]', P='7-10.5'
2025-04-20 01:45:20,907 - INFO - app.py:205 - Extraction done. Found 4 events.
2025-04-20 01:45:20,907 - DEBUG - app.py:206 - --- Final Extracted Schedule List (No Color) ---
[{'date': '20/05/2025',
  'day_name': 'TH·ª® 3',
  'description_extra': '',
  'end_datetime': '2025-05-20T09:30:00',
  'location': '',
  'periods': '1-3',
  'room': 'B1.305',
  'start_datetime': '2025-05-20T07:00:00',
  'subject': 'K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]',
  'teacher': '',
  'time_range': '7h00 -> 9h30'},
 {'date': '20/05/2025',
  'day_name': 'TH·ª® 3',
  'description_extra': '',
  'end_datetime': '2025-05-20T16:30:00',
  'location': '',
  'periods': '7-10.5',
  'room': 'B1.305',
  'start_datetime': '2025-05-20T12:30:00',
  'subject': 'Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]',
  'teacher': '',
  'time_range': '12h30 -> 16h30'},
 {'date': '22/05/2025',
  'day_name': 'TH·ª® 5',
  'description_extra': '',
  'end_datetime': '2025-05-22T09:30:00',
  'location': '',
  'periods': '1-3',
  'room': 'B1.305',
  'start_datetime': '2025-05-22T07:00:00',
  'subject': 'K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]',
  'teacher': '',
  'time_range': '7h00 -> 9h30'},
 {'date': '22/05/2025',
  'day_name': 'TH·ª® 5',
  'description_extra': '',
  'end_datetime': '2025-05-22T16:30:00',
  'location': '',
  'periods': '7-10.5',
  'room': 'B1.305',
  'start_datetime': '2025-05-22T12:30:00',
  'subject': 'Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]',
  'teacher': '',
  'time_range': '12h30 -> 16h30'}]
--- End List ---
2025-04-20 01:45:20,907 - INFO - app.py:273 - Extracted 4 events for 19/05/2025-25/05/2025
2025-04-20 01:45:20,907 - INFO - app.py:295 - Fetching existing events: 2025-05-18T17:00:00Z to 2025-05-25T16:59:59Z
2025-04-20 01:45:20,913 - DEBUG - discovery.py:1256 - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/primary/events?timeMin=2025-05-18T17%3A00%3A00Z&timeMax=2025-05-25T16%3A59%3A59Z&singleEvents=true&maxResults=250&alt=json
2025-04-20 01:45:21,494 - INFO - app.py:310 - Found 0 existing events details in Google Calendar for the week.
2025-04-20 01:45:21,494 - INFO - app.py:326 - Processing 4 extracted events against 0 existing ones...
2025-04-20 01:45:21,495 - DEBUG - app.py:336 - Event 1 ('K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]' Color: 1) marked for BATCH insert.
2025-04-20 01:45:21,503 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:21,503 - DEBUG - app.py:336 - Event 2 ('Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]' Color: 2) marked for BATCH insert.
2025-04-20 01:45:21,508 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:21,508 - DEBUG - app.py:336 - Event 3 ('K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]' Color: 1) marked for BATCH insert.
2025-04-20 01:45:21,512 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:21,513 - DEBUG - app.py:336 - Event 4 ('Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]' Color: 3) marked for BATCH insert.
2025-04-20 01:45:21,518 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:21,518 - INFO - app.py:346 - Executing batch request to insert 4 events...
2025-04-20 01:45:22,335 - INFO - app.py:235 - Batch request item event-1-K·∫ø to√°n t√† succeeded. Event ID: 9b6vu5q82ua60om967oad5erdc
2025-04-20 01:45:22,335 - INFO - app.py:235 - Batch request item event-2-Qu·∫£n tr·ªã t succeeded. Event ID: bfqvqsoubc1078slq7322e08r8
2025-04-20 01:45:22,336 - INFO - app.py:235 - Batch request item event-3-K·∫ø to√°n t√† succeeded. Event ID: ackqumqbmbe3huomhnm37i4kf0
2025-04-20 01:45:22,336 - INFO - app.py:235 - Batch request item event-4-Kinh doanh succeeded. Event ID: ki6ovfhg1t798r66ee8ot65q8c
2025-04-20 01:45:22,336 - INFO - app.py:351 - Batch executed. Callback results: Added=4, Errors=0
2025-04-20 01:45:22,336 - INFO - app.py:362 - Sync done: user=fff@st.uel.edu.vn, week=19/05/2025-25/05/2025, Added=4, Skipped=0, Errors=0, Time=1.44s
2025-04-20 01:45:22,337 - INFO - _internal.py:97 - 127.0.0.1 - - [20/Apr/2025 01:45:22] "POST /sync_from_extension HTTP/1.1" 200 -
2025-04-20 01:45:23,359 - INFO - app.py:243 - Request /sync_from_extension (Batch Optimized, Color by Subject)
2025-04-20 01:45:23,359 - DEBUG - app.py:253 - Sync Data: user='fff@st.uel.edu.vn', date='T·ª´ ng√†y 26/05/2025 ƒë·∫øn ng√†y 01/06/2025', html=Yes
2025-04-20 01:45:23,359 - INFO - app.py:259 - Processing sync for user: fff@st.uel.edu.vn
2025-04-20 01:45:23,361 - INFO - app.py:66 - Service built from token OK.
2025-04-20 01:45:23,361 - INFO - app.py:74 - Starting schedule extraction (Flexible Parsing).
2025-04-20 01:45:23,362 - INFO - app.py:85 - Parsed week: 26/05/2025 - 01/06/2025
2025-04-20 01:45:23,363 - DEBUG - app.py:99 - Headers: ['PH√íNG', 'TH·ª® 2', 'TH·ª® 3', 'TH·ª® 4', 'TH·ª® 5', 'TH·ª® 6', 'TH·ª® 7', 'CH·ª¶ NH·∫¨T']
2025-04-20 01:45:23,363 - INFO - app.py:114 - Header: RoomIdx=0, DayIndices={'TH·ª® 2': 1, 'TH·ª® 3': 2, 'TH·ª® 4': 3, 'TH·ª® 5': 4, 'TH·ª® 6': 5, 'TH·ª® 7': 6, 'CH·ª¶ NH·∫¨T': 7}
2025-04-20 01:45:23,363 - DEBUG - app.py:125 - Row 2: Room='B1.305'
2025-04-20 01:45:23,364 - DEBUG - app.py:142 - Cell(2,2), Block 1: Lines=['K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', '7h00 -> 9h30', 'Ti·∫øt 1-3', 'GV:']
2025-04-20 01:45:23,364 - DEBUG - app.py:160 - Time match: Raw='7h00 -> 9h30'
2025-04-20 01:45:23,364 - DEBUG - app.py:164 - Periods regex: '1-3'
2025-04-20 01:45:23,364 - DEBUG - app.py:193 - Final DateTime: Start=2025-05-27T07:00:00, End=2025-05-27T09:30:00
2025-04-20 01:45:23,364 - DEBUG - app.py:199 - Prepared: Sub='K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', P='1-3'
2025-04-20 01:45:23,365 - DEBUG - app.py:142 - Cell(2,2), Block 2: Lines=['Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]', '12h30 -> 16h30', 'Ti·∫øt 7-10.5', 'GV:']
2025-04-20 01:45:23,365 - DEBUG - app.py:160 - Time match: Raw='12h30 -> 16h30'
2025-04-20 01:45:23,365 - DEBUG - app.py:164 - Periods regex: '7-10.5'
2025-04-20 01:45:23,365 - DEBUG - app.py:193 - Final DateTime: Start=2025-05-27T12:30:00, End=2025-05-27T16:30:00
2025-04-20 01:45:23,365 - DEBUG - app.py:199 - Prepared: Sub='Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]', P='7-10.5'
2025-04-20 01:45:23,365 - DEBUG - app.py:142 - Cell(2,4), Block 1: Lines=['K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', '7h00 -> 9h30', 'Ti·∫øt 1-3', 'GV:']
2025-04-20 01:45:23,365 - DEBUG - app.py:160 - Time match: Raw='7h00 -> 9h30'
2025-04-20 01:45:23,365 - DEBUG - app.py:164 - Periods regex: '1-3'
2025-04-20 01:45:23,365 - DEBUG - app.py:193 - Final DateTime: Start=2025-05-29T07:00:00, End=2025-05-29T09:30:00
2025-04-20 01:45:23,365 - DEBUG - app.py:199 - Prepared: Sub='K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', P='1-3'
2025-04-20 01:45:23,366 - DEBUG - app.py:142 - Cell(2,4), Block 2: Lines=['Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]', '12h30 -> 16h30', 'Ti·∫øt 7-10.5', 'GV:']
2025-04-20 01:45:23,366 - DEBUG - app.py:160 - Time match: Raw='12h30 -> 16h30'
2025-04-20 01:45:23,366 - DEBUG - app.py:164 - Periods regex: '7-10.5'
2025-04-20 01:45:23,366 - DEBUG - app.py:193 - Final DateTime: Start=2025-05-29T12:30:00, End=2025-05-29T16:30:00
2025-04-20 01:45:23,366 - DEBUG - app.py:199 - Prepared: Sub='Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]', P='7-10.5'
2025-04-20 01:45:23,366 - INFO - app.py:205 - Extraction done. Found 4 events.
2025-04-20 01:45:23,367 - DEBUG - app.py:206 - --- Final Extracted Schedule List (No Color) ---
[{'date': '27/05/2025',
  'day_name': 'TH·ª® 3',
  'description_extra': '',
  'end_datetime': '2025-05-27T09:30:00',
  'location': '',
  'periods': '1-3',
  'room': 'B1.305',
  'start_datetime': '2025-05-27T07:00:00',
  'subject': 'K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]',
  'teacher': '',
  'time_range': '7h00 -> 9h30'},
 {'date': '27/05/2025',
  'day_name': 'TH·ª® 3',
  'description_extra': '',
  'end_datetime': '2025-05-27T16:30:00',
  'location': '',
  'periods': '7-10.5',
  'room': 'B1.305',
  'start_datetime': '2025-05-27T12:30:00',
  'subject': 'Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]',
  'teacher': '',
  'time_range': '12h30 -> 16h30'},
 {'date': '29/05/2025',
  'day_name': 'TH·ª® 5',
  'description_extra': '',
  'end_datetime': '2025-05-29T09:30:00',
  'location': '',
  'periods': '1-3',
  'room': 'B1.305',
  'start_datetime': '2025-05-29T07:00:00',
  'subject': 'K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]',
  'teacher': '',
  'time_range': '7h00 -> 9h30'},
 {'date': '29/05/2025',
  'day_name': 'TH·ª® 5',
  'description_extra': '',
  'end_datetime': '2025-05-29T16:30:00',
  'location': '',
  'periods': '7-10.5',
  'room': 'B1.305',
  'start_datetime': '2025-05-29T12:30:00',
  'subject': 'Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]',
  'teacher': '',
  'time_range': '12h30 -> 16h30'}]
--- End List ---
2025-04-20 01:45:23,367 - INFO - app.py:273 - Extracted 4 events for 26/05/2025-01/06/2025
2025-04-20 01:45:23,367 - INFO - app.py:295 - Fetching existing events: 2025-05-25T17:00:00Z to 2025-06-01T16:59:59Z
2025-04-20 01:45:23,372 - DEBUG - discovery.py:1256 - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/primary/events?timeMin=2025-05-25T17%3A00%3A00Z&timeMax=2025-06-01T16%3A59%3A59Z&singleEvents=true&maxResults=250&alt=json
2025-04-20 01:45:23,873 - INFO - app.py:310 - Found 0 existing events details in Google Calendar for the week.
2025-04-20 01:45:23,873 - INFO - app.py:326 - Processing 4 extracted events against 0 existing ones...
2025-04-20 01:45:23,873 - DEBUG - app.py:336 - Event 1 ('K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]' Color: 1) marked for BATCH insert.
2025-04-20 01:45:23,878 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:23,878 - DEBUG - app.py:336 - Event 2 ('Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]' Color: 2) marked for BATCH insert.
2025-04-20 01:45:23,883 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:23,884 - DEBUG - app.py:336 - Event 3 ('K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]' Color: 1) marked for BATCH insert.
2025-04-20 01:45:23,889 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:23,889 - DEBUG - app.py:336 - Event 4 ('Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]' Color: 3) marked for BATCH insert.
2025-04-20 01:45:23,893 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:23,893 - INFO - app.py:346 - Executing batch request to insert 4 events...
2025-04-20 01:45:24,607 - INFO - app.py:235 - Batch request item event-1-K·∫ø to√°n t√† succeeded. Event ID: mt116bqc7rfnvp4mk5luludkv8
2025-04-20 01:45:24,607 - INFO - app.py:235 - Batch request item event-2-Qu·∫£n tr·ªã t succeeded. Event ID: gjcromq2h61677qlfqot911nus
2025-04-20 01:45:24,607 - INFO - app.py:235 - Batch request item event-3-K·∫ø to√°n t√† succeeded. Event ID: aa3dan119eg7bndpp4d0v0c5cc
2025-04-20 01:45:24,608 - INFO - app.py:235 - Batch request item event-4-Kinh doanh succeeded. Event ID: bri89j8b608mbp88424nmv41bo
2025-04-20 01:45:24,608 - INFO - app.py:351 - Batch executed. Callback results: Added=4, Errors=0
2025-04-20 01:45:24,608 - INFO - app.py:362 - Sync done: user=fff@st.uel.edu.vn, week=26/05/2025-01/06/2025, Added=4, Skipped=0, Errors=0, Time=1.25s
2025-04-20 01:45:24,609 - INFO - _internal.py:97 - 127.0.0.1 - - [20/Apr/2025 01:45:24] "POST /sync_from_extension HTTP/1.1" 200 -
2025-04-20 01:45:25,628 - INFO - app.py:243 - Request /sync_from_extension (Batch Optimized, Color by Subject)
2025-04-20 01:45:25,629 - DEBUG - app.py:253 - Sync Data: user='fff@st.uel.edu.vn', date='T·ª´ ng√†y 02/06/2025 ƒë·∫øn ng√†y 08/06/2025', html=Yes
2025-04-20 01:45:25,629 - INFO - app.py:259 - Processing sync for user: fff@st.uel.edu.vn
2025-04-20 01:45:25,633 - INFO - app.py:66 - Service built from token OK.
2025-04-20 01:45:25,634 - INFO - app.py:74 - Starting schedule extraction (Flexible Parsing).
2025-04-20 01:45:25,634 - INFO - app.py:85 - Parsed week: 02/06/2025 - 08/06/2025
2025-04-20 01:45:25,635 - DEBUG - app.py:99 - Headers: ['PH√íNG', 'TH·ª® 2', 'TH·ª® 3', 'TH·ª® 4', 'TH·ª® 5', 'TH·ª® 6', 'TH·ª® 7', 'CH·ª¶ NH·∫¨T']
2025-04-20 01:45:25,635 - INFO - app.py:114 - Header: RoomIdx=0, DayIndices={'TH·ª® 2': 1, 'TH·ª® 3': 2, 'TH·ª® 4': 3, 'TH·ª® 5': 4, 'TH·ª® 6': 5, 'TH·ª® 7': 6, 'CH·ª¶ NH·∫¨T': 7}
2025-04-20 01:45:25,635 - DEBUG - app.py:125 - Row 2: Room='B1.305'
2025-04-20 01:45:25,636 - DEBUG - app.py:142 - Cell(2,2), Block 1: Lines=['K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', '7h00 -> 9h30', 'Ti·∫øt 1-3', 'GV:']
2025-04-20 01:45:25,636 - DEBUG - app.py:160 - Time match: Raw='7h00 -> 9h30'
2025-04-20 01:45:25,636 - DEBUG - app.py:164 - Periods regex: '1-3'
2025-04-20 01:45:25,636 - DEBUG - app.py:193 - Final DateTime: Start=2025-06-03T07:00:00, End=2025-06-03T09:30:00
2025-04-20 01:45:25,636 - DEBUG - app.py:199 - Prepared: Sub='K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', P='1-3'
2025-04-20 01:45:25,636 - DEBUG - app.py:142 - Cell(2,2), Block 2: Lines=['Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]', '12h30 -> 16h30', 'Ti·∫øt 7-10.5', 'GV:']
2025-04-20 01:45:25,636 - DEBUG - app.py:160 - Time match: Raw='12h30 -> 16h30'
2025-04-20 01:45:25,637 - DEBUG - app.py:164 - Periods regex: '7-10.5'
2025-04-20 01:45:25,637 - DEBUG - app.py:193 - Final DateTime: Start=2025-06-03T12:30:00, End=2025-06-03T16:30:00
2025-04-20 01:45:25,637 - DEBUG - app.py:199 - Prepared: Sub='Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]', P='7-10.5'
2025-04-20 01:45:25,637 - DEBUG - app.py:142 - Cell(2,4), Block 1: Lines=['K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', '7h00 -> 9h30', 'Ti·∫øt 1-3', 'GV:']
2025-04-20 01:45:25,637 - DEBUG - app.py:160 - Time match: Raw='7h00 -> 9h30'
2025-04-20 01:45:25,637 - DEBUG - app.py:164 - Periods regex: '1-3'
2025-04-20 01:45:25,637 - DEBUG - app.py:193 - Final DateTime: Start=2025-06-05T07:00:00, End=2025-06-05T09:30:00
2025-04-20 01:45:25,637 - DEBUG - app.py:199 - Prepared: Sub='K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', P='1-3'
2025-04-20 01:45:25,638 - DEBUG - app.py:142 - Cell(2,4), Block 2: Lines=['Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]', '12h30 -> 16h30', 'Ti·∫øt 7-10.5', 'GV:']
2025-04-20 01:45:25,638 - DEBUG - app.py:160 - Time match: Raw='12h30 -> 16h30'
2025-04-20 01:45:25,638 - DEBUG - app.py:164 - Periods regex: '7-10.5'
2025-04-20 01:45:25,638 - DEBUG - app.py:193 - Final DateTime: Start=2025-06-05T12:30:00, End=2025-06-05T16:30:00
2025-04-20 01:45:25,638 - DEBUG - app.py:199 - Prepared: Sub='Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]', P='7-10.5'
2025-04-20 01:45:25,638 - INFO - app.py:205 - Extraction done. Found 4 events.
2025-04-20 01:45:25,639 - DEBUG - app.py:206 - --- Final Extracted Schedule List (No Color) ---
[{'date': '03/06/2025',
  'day_name': 'TH·ª® 3',
  'description_extra': '',
  'end_datetime': '2025-06-03T09:30:00',
  'location': '',
  'periods': '1-3',
  'room': 'B1.305',
  'start_datetime': '2025-06-03T07:00:00',
  'subject': 'K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]',
  'teacher': '',
  'time_range': '7h00 -> 9h30'},
 {'date': '03/06/2025',
  'day_name': 'TH·ª® 3',
  'description_extra': '',
  'end_datetime': '2025-06-03T16:30:00',
  'location': '',
  'periods': '7-10.5',
  'room': 'B1.305',
  'start_datetime': '2025-06-03T12:30:00',
  'subject': 'Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]',
  'teacher': '',
  'time_range': '12h30 -> 16h30'},
 {'date': '05/06/2025',
  'day_name': 'TH·ª® 5',
  'description_extra': '',
  'end_datetime': '2025-06-05T09:30:00',
  'location': '',
  'periods': '1-3',
  'room': 'B1.305',
  'start_datetime': '2025-06-05T07:00:00',
  'subject': 'K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]',
  'teacher': '',
  'time_range': '7h00 -> 9h30'},
 {'date': '05/06/2025',
  'day_name': 'TH·ª® 5',
  'description_extra': '',
  'end_datetime': '2025-06-05T16:30:00',
  'location': '',
  'periods': '7-10.5',
  'room': 'B1.305',
  'start_datetime': '2025-06-05T12:30:00',
  'subject': 'Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]',
  'teacher': '',
  'time_range': '12h30 -> 16h30'}]
--- End List ---
2025-04-20 01:45:25,639 - INFO - app.py:273 - Extracted 4 events for 02/06/2025-08/06/2025
2025-04-20 01:45:25,639 - INFO - app.py:295 - Fetching existing events: 2025-06-01T17:00:00Z to 2025-06-08T16:59:59Z
2025-04-20 01:45:25,645 - DEBUG - discovery.py:1256 - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/primary/events?timeMin=2025-06-01T17%3A00%3A00Z&timeMax=2025-06-08T16%3A59%3A59Z&singleEvents=true&maxResults=250&alt=json
2025-04-20 01:45:26,252 - INFO - app.py:310 - Found 0 existing events details in Google Calendar for the week.
2025-04-20 01:45:26,252 - INFO - app.py:326 - Processing 4 extracted events against 0 existing ones...
2025-04-20 01:45:26,252 - DEBUG - app.py:336 - Event 1 ('K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]' Color: 1) marked for BATCH insert.
2025-04-20 01:45:26,260 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:26,260 - DEBUG - app.py:336 - Event 2 ('Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]' Color: 2) marked for BATCH insert.
2025-04-20 01:45:26,266 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:26,267 - DEBUG - app.py:336 - Event 3 ('K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]' Color: 1) marked for BATCH insert.
2025-04-20 01:45:26,270 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:26,270 - DEBUG - app.py:336 - Event 4 ('Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]' Color: 3) marked for BATCH insert.
2025-04-20 01:45:26,273 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:26,273 - INFO - app.py:346 - Executing batch request to insert 4 events...
2025-04-20 01:45:26,925 - INFO - app.py:235 - Batch request item event-1-K·∫ø to√°n t√† succeeded. Event ID: d8o1n19o1b9cn7cifrchnv1kqg
2025-04-20 01:45:26,925 - INFO - app.py:235 - Batch request item event-2-Qu·∫£n tr·ªã t succeeded. Event ID: 51bjc350inrslgujpbeuo7icvg
2025-04-20 01:45:26,925 - INFO - app.py:235 - Batch request item event-3-K·∫ø to√°n t√† succeeded. Event ID: p0rplu7e3qhl32rrpo1h5acbds
2025-04-20 01:45:26,926 - INFO - app.py:235 - Batch request item event-4-Kinh doanh succeeded. Event ID: ntkit02p6rgpia92d3322lg1fs
2025-04-20 01:45:26,926 - INFO - app.py:351 - Batch executed. Callback results: Added=4, Errors=0
2025-04-20 01:45:26,926 - INFO - app.py:362 - Sync done: user=fff@st.uel.edu.vn, week=02/06/2025-08/06/2025, Added=4, Skipped=0, Errors=0, Time=1.30s
2025-04-20 01:45:26,926 - INFO - _internal.py:97 - 127.0.0.1 - - [20/Apr/2025 01:45:26] "POST /sync_from_extension HTTP/1.1" 200 -
2025-04-20 01:45:27,945 - INFO - app.py:243 - Request /sync_from_extension (Batch Optimized, Color by Subject)
2025-04-20 01:45:27,945 - DEBUG - app.py:253 - Sync Data: user='fff@st.uel.edu.vn', date='T·ª´ ng√†y 09/06/2025 ƒë·∫øn ng√†y 15/06/2025', html=Yes
2025-04-20 01:45:27,945 - INFO - app.py:259 - Processing sync for user: fff@st.uel.edu.vn
2025-04-20 01:45:27,950 - INFO - app.py:66 - Service built from token OK.
2025-04-20 01:45:27,950 - INFO - app.py:74 - Starting schedule extraction (Flexible Parsing).
2025-04-20 01:45:27,950 - INFO - app.py:85 - Parsed week: 09/06/2025 - 15/06/2025
2025-04-20 01:45:27,952 - DEBUG - app.py:99 - Headers: ['PH√íNG', 'TH·ª® 2', 'TH·ª® 3', 'TH·ª® 4', 'TH·ª® 5', 'TH·ª® 6', 'TH·ª® 7', 'CH·ª¶ NH·∫¨T']
2025-04-20 01:45:27,952 - INFO - app.py:114 - Header: RoomIdx=0, DayIndices={'TH·ª® 2': 1, 'TH·ª® 3': 2, 'TH·ª® 4': 3, 'TH·ª® 5': 4, 'TH·ª® 6': 5, 'TH·ª® 7': 6, 'CH·ª¶ NH·∫¨T': 7}
2025-04-20 01:45:27,952 - DEBUG - app.py:125 - Row 2: Room='B1.305'
2025-04-20 01:45:27,952 - DEBUG - app.py:142 - Cell(2,2), Block 1: Lines=['K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', '7h00 -> 9h30', 'Ti·∫øt 1-3', 'GV:']
2025-04-20 01:45:27,952 - DEBUG - app.py:160 - Time match: Raw='7h00 -> 9h30'
2025-04-20 01:45:27,952 - DEBUG - app.py:164 - Periods regex: '1-3'
2025-04-20 01:45:27,953 - DEBUG - app.py:193 - Final DateTime: Start=2025-06-10T07:00:00, End=2025-06-10T09:30:00
2025-04-20 01:45:27,953 - DEBUG - app.py:199 - Prepared: Sub='K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', P='1-3'
2025-04-20 01:45:27,953 - DEBUG - app.py:142 - Cell(2,2), Block 2: Lines=['Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]', '12h30 -> 16h30', 'Ti·∫øt 7-10.5', 'GV:']
2025-04-20 01:45:27,953 - DEBUG - app.py:160 - Time match: Raw='12h30 -> 16h30'
2025-04-20 01:45:27,953 - DEBUG - app.py:164 - Periods regex: '7-10.5'
2025-04-20 01:45:27,953 - DEBUG - app.py:193 - Final DateTime: Start=2025-06-10T12:30:00, End=2025-06-10T16:30:00
2025-04-20 01:45:27,953 - DEBUG - app.py:199 - Prepared: Sub='Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]', P='7-10.5'
2025-04-20 01:45:27,954 - DEBUG - app.py:142 - Cell(2,4), Block 1: Lines=['K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', '7h00 -> 9h30', 'Ti·∫øt 1-3', 'GV:']
2025-04-20 01:45:27,954 - DEBUG - app.py:160 - Time match: Raw='7h00 -> 9h30'
2025-04-20 01:45:27,954 - DEBUG - app.py:164 - Periods regex: '1-3'
2025-04-20 01:45:27,954 - DEBUG - app.py:193 - Final DateTime: Start=2025-06-12T07:00:00, End=2025-06-12T09:30:00
2025-04-20 01:45:27,954 - DEBUG - app.py:199 - Prepared: Sub='K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', P='1-3'
2025-04-20 01:45:27,954 - DEBUG - app.py:142 - Cell(2,4), Block 2: Lines=['Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]', '12h30 -> 16h30', 'Ti·∫øt 7-10.5', 'GV:']
2025-04-20 01:45:27,954 - DEBUG - app.py:160 - Time match: Raw='12h30 -> 16h30'
2025-04-20 01:45:27,954 - DEBUG - app.py:164 - Periods regex: '7-10.5'
2025-04-20 01:45:27,954 - DEBUG - app.py:193 - Final DateTime: Start=2025-06-12T12:30:00, End=2025-06-12T16:30:00
2025-04-20 01:45:27,954 - DEBUG - app.py:199 - Prepared: Sub='Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]', P='7-10.5'
2025-04-20 01:45:27,954 - INFO - app.py:205 - Extraction done. Found 4 events.
2025-04-20 01:45:27,955 - DEBUG - app.py:206 - --- Final Extracted Schedule List (No Color) ---
[{'date': '10/06/2025',
  'day_name': 'TH·ª® 3',
  'description_extra': '',
  'end_datetime': '2025-06-10T09:30:00',
  'location': '',
  'periods': '1-3',
  'room': 'B1.305',
  'start_datetime': '2025-06-10T07:00:00',
  'subject': 'K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]',
  'teacher': '',
  'time_range': '7h00 -> 9h30'},
 {'date': '10/06/2025',
  'day_name': 'TH·ª® 3',
  'description_extra': '',
  'end_datetime': '2025-06-10T16:30:00',
  'location': '',
  'periods': '7-10.5',
  'room': 'B1.305',
  'start_datetime': '2025-06-10T12:30:00',
  'subject': 'Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]',
  'teacher': '',
  'time_range': '12h30 -> 16h30'},
 {'date': '12/06/2025',
  'day_name': 'TH·ª® 5',
  'description_extra': '',
  'end_datetime': '2025-06-12T09:30:00',
  'location': '',
  'periods': '1-3',
  'room': 'B1.305',
  'start_datetime': '2025-06-12T07:00:00',
  'subject': 'K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]',
  'teacher': '',
  'time_range': '7h00 -> 9h30'},
 {'date': '12/06/2025',
  'day_name': 'TH·ª® 5',
  'description_extra': '',
  'end_datetime': '2025-06-12T16:30:00',
  'location': '',
  'periods': '7-10.5',
  'room': 'B1.305',
  'start_datetime': '2025-06-12T12:30:00',
  'subject': 'Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]',
  'teacher': '',
  'time_range': '12h30 -> 16h30'}]
--- End List ---
2025-04-20 01:45:27,955 - INFO - app.py:273 - Extracted 4 events for 09/06/2025-15/06/2025
2025-04-20 01:45:27,955 - INFO - app.py:295 - Fetching existing events: 2025-06-08T17:00:00Z to 2025-06-15T16:59:59Z
2025-04-20 01:45:27,961 - DEBUG - discovery.py:1256 - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/primary/events?timeMin=2025-06-08T17%3A00%3A00Z&timeMax=2025-06-15T16%3A59%3A59Z&singleEvents=true&maxResults=250&alt=json
2025-04-20 01:45:28,496 - INFO - app.py:310 - Found 0 existing events details in Google Calendar for the week.
2025-04-20 01:45:28,496 - INFO - app.py:326 - Processing 4 extracted events against 0 existing ones...
2025-04-20 01:45:28,496 - DEBUG - app.py:336 - Event 1 ('K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]' Color: 1) marked for BATCH insert.
2025-04-20 01:45:28,504 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:28,505 - DEBUG - app.py:336 - Event 2 ('Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]' Color: 2) marked for BATCH insert.
2025-04-20 01:45:28,511 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:28,511 - DEBUG - app.py:336 - Event 3 ('K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]' Color: 1) marked for BATCH insert.
2025-04-20 01:45:28,516 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:28,516 - DEBUG - app.py:336 - Event 4 ('Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]' Color: 3) marked for BATCH insert.
2025-04-20 01:45:28,520 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:28,521 - INFO - app.py:346 - Executing batch request to insert 4 events...
2025-04-20 01:45:29,181 - INFO - app.py:235 - Batch request item event-1-K·∫ø to√°n t√† succeeded. Event ID: 17aae4su08p3obq57tkgrq46qs
2025-04-20 01:45:29,181 - INFO - app.py:235 - Batch request item event-2-Qu·∫£n tr·ªã t succeeded. Event ID: hum6n20b36lou9r23rkk2c7u0s
2025-04-20 01:45:29,181 - INFO - app.py:235 - Batch request item event-3-K·∫ø to√°n t√† succeeded. Event ID: m242u8qtouugkh5n1kt7kuau70
2025-04-20 01:45:29,182 - INFO - app.py:235 - Batch request item event-4-Kinh doanh succeeded. Event ID: k0hins5h563d2rmet3eagrgfkk
2025-04-20 01:45:29,182 - INFO - app.py:351 - Batch executed. Callback results: Added=4, Errors=0
2025-04-20 01:45:29,182 - INFO - app.py:362 - Sync done: user=fff@st.uel.edu.vn, week=09/06/2025-15/06/2025, Added=4, Skipped=0, Errors=0, Time=1.24s
2025-04-20 01:45:29,183 - INFO - _internal.py:97 - 127.0.0.1 - - [20/Apr/2025 01:45:29] "POST /sync_from_extension HTTP/1.1" 200 -
2025-04-20 01:45:30,200 - INFO - app.py:243 - Request /sync_from_extension (Batch Optimized, Color by Subject)
2025-04-20 01:45:30,200 - DEBUG - app.py:253 - Sync Data: user='fff@st.uel.edu.vn', date='T·ª´ ng√†y 16/06/2025 ƒë·∫øn ng√†y 22/06/2025', html=Yes
2025-04-20 01:45:30,200 - INFO - app.py:259 - Processing sync for user: fff@st.uel.edu.vn
2025-04-20 01:45:30,205 - INFO - app.py:66 - Service built from token OK.
2025-04-20 01:45:30,205 - INFO - app.py:74 - Starting schedule extraction (Flexible Parsing).
2025-04-20 01:45:30,205 - INFO - app.py:85 - Parsed week: 16/06/2025 - 22/06/2025
2025-04-20 01:45:30,206 - DEBUG - app.py:99 - Headers: ['PH√íNG', 'TH·ª® 2', 'TH·ª® 3', 'TH·ª® 4', 'TH·ª® 5', 'TH·ª® 6', 'TH·ª® 7', 'CH·ª¶ NH·∫¨T']
2025-04-20 01:45:30,207 - INFO - app.py:114 - Header: RoomIdx=0, DayIndices={'TH·ª® 2': 1, 'TH·ª® 3': 2, 'TH·ª® 4': 3, 'TH·ª® 5': 4, 'TH·ª® 6': 5, 'TH·ª® 7': 6, 'CH·ª¶ NH·∫¨T': 7}
2025-04-20 01:45:30,207 - DEBUG - app.py:125 - Row 2: Room='B1.305'
2025-04-20 01:45:30,207 - DEBUG - app.py:142 - Cell(2,2), Block 1: Lines=['K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', '7h00 -> 9h30', 'Ti·∫øt 1-3', 'GV:']
2025-04-20 01:45:30,207 - DEBUG - app.py:160 - Time match: Raw='7h00 -> 9h30'
2025-04-20 01:45:30,207 - DEBUG - app.py:164 - Periods regex: '1-3'
2025-04-20 01:45:30,207 - DEBUG - app.py:193 - Final DateTime: Start=2025-06-17T07:00:00, End=2025-06-17T09:30:00
2025-04-20 01:45:30,207 - DEBUG - app.py:199 - Prepared: Sub='K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', P='1-3'
2025-04-20 01:45:30,208 - DEBUG - app.py:142 - Cell(2,2), Block 2: Lines=['Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]', '12h30 -> 16h30', 'Ti·∫øt 7-10.5', 'GV:']
2025-04-20 01:45:30,208 - DEBUG - app.py:160 - Time match: Raw='12h30 -> 16h30'
2025-04-20 01:45:30,208 - DEBUG - app.py:164 - Periods regex: '7-10.5'
2025-04-20 01:45:30,208 - DEBUG - app.py:193 - Final DateTime: Start=2025-06-17T12:30:00, End=2025-06-17T16:30:00
2025-04-20 01:45:30,208 - DEBUG - app.py:199 - Prepared: Sub='Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]', P='7-10.5'
2025-04-20 01:45:30,208 - DEBUG - app.py:142 - Cell(2,4), Block 1: Lines=['K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', '7h00 -> 9h30', 'Ti·∫øt 1-3', 'GV:']
2025-04-20 01:45:30,208 - DEBUG - app.py:160 - Time match: Raw='7h00 -> 9h30'
2025-04-20 01:45:30,208 - DEBUG - app.py:164 - Periods regex: '1-3'
2025-04-20 01:45:30,208 - DEBUG - app.py:193 - Final DateTime: Start=2025-06-19T07:00:00, End=2025-06-19T09:30:00
2025-04-20 01:45:30,208 - DEBUG - app.py:199 - Prepared: Sub='K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', P='1-3'
2025-04-20 01:45:30,209 - DEBUG - app.py:142 - Cell(2,4), Block 2: Lines=['Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]', '12h30 -> 16h30', 'Ti·∫øt 7-10.5', 'GV:']
2025-04-20 01:45:30,209 - DEBUG - app.py:160 - Time match: Raw='12h30 -> 16h30'
2025-04-20 01:45:30,209 - DEBUG - app.py:164 - Periods regex: '7-10.5'
2025-04-20 01:45:30,209 - DEBUG - app.py:193 - Final DateTime: Start=2025-06-19T12:30:00, End=2025-06-19T16:30:00
2025-04-20 01:45:30,209 - DEBUG - app.py:199 - Prepared: Sub='Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]', P='7-10.5'
2025-04-20 01:45:30,209 - INFO - app.py:205 - Extraction done. Found 4 events.
2025-04-20 01:45:30,210 - DEBUG - app.py:206 - --- Final Extracted Schedule List (No Color) ---
[{'date': '17/06/2025',
  'day_name': 'TH·ª® 3',
  'description_extra': '',
  'end_datetime': '2025-06-17T09:30:00',
  'location': '',
  'periods': '1-3',
  'room': 'B1.305',
  'start_datetime': '2025-06-17T07:00:00',
  'subject': 'K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]',
  'teacher': '',
  'time_range': '7h00 -> 9h30'},
 {'date': '17/06/2025',
  'day_name': 'TH·ª® 3',
  'description_extra': '',
  'end_datetime': '2025-06-17T16:30:00',
  'location': '',
  'periods': '7-10.5',
  'room': 'B1.305',
  'start_datetime': '2025-06-17T12:30:00',
  'subject': 'Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]',
  'teacher': '',
  'time_range': '12h30 -> 16h30'},
 {'date': '19/06/2025',
  'day_name': 'TH·ª® 5',
  'description_extra': '',
  'end_datetime': '2025-06-19T09:30:00',
  'location': '',
  'periods': '1-3',
  'room': 'B1.305',
  'start_datetime': '2025-06-19T07:00:00',
  'subject': 'K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]',
  'teacher': '',
  'time_range': '7h00 -> 9h30'},
 {'date': '19/06/2025',
  'day_name': 'TH·ª® 5',
  'description_extra': '',
  'end_datetime': '2025-06-19T16:30:00',
  'location': '',
  'periods': '7-10.5',
  'room': 'B1.305',
  'start_datetime': '2025-06-19T12:30:00',
  'subject': 'Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]',
  'teacher': '',
  'time_range': '12h30 -> 16h30'}]
--- End List ---
2025-04-20 01:45:30,210 - INFO - app.py:273 - Extracted 4 events for 16/06/2025-22/06/2025
2025-04-20 01:45:30,210 - INFO - app.py:295 - Fetching existing events: 2025-06-15T17:00:00Z to 2025-06-22T16:59:59Z
2025-04-20 01:45:30,215 - DEBUG - discovery.py:1256 - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/primary/events?timeMin=2025-06-15T17%3A00%3A00Z&timeMax=2025-06-22T16%3A59%3A59Z&singleEvents=true&maxResults=250&alt=json
2025-04-20 01:45:30,719 - INFO - app.py:310 - Found 0 existing events details in Google Calendar for the week.
2025-04-20 01:45:30,719 - INFO - app.py:326 - Processing 4 extracted events against 0 existing ones...
2025-04-20 01:45:30,719 - DEBUG - app.py:336 - Event 1 ('K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]' Color: 1) marked for BATCH insert.
2025-04-20 01:45:30,728 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:30,728 - DEBUG - app.py:336 - Event 2 ('Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]' Color: 2) marked for BATCH insert.
2025-04-20 01:45:30,734 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:30,734 - DEBUG - app.py:336 - Event 3 ('K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]' Color: 1) marked for BATCH insert.
2025-04-20 01:45:30,739 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:30,739 - DEBUG - app.py:336 - Event 4 ('Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]' Color: 3) marked for BATCH insert.
2025-04-20 01:45:30,743 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:30,743 - INFO - app.py:346 - Executing batch request to insert 4 events...
2025-04-20 01:45:31,363 - INFO - app.py:235 - Batch request item event-1-K·∫ø to√°n t√† succeeded. Event ID: bgk499veghhj115ku0dve9nfu8
2025-04-20 01:45:31,364 - INFO - app.py:235 - Batch request item event-2-Qu·∫£n tr·ªã t succeeded. Event ID: 2pcmobkmmkr9gktja3so3ghsa0
2025-04-20 01:45:31,364 - INFO - app.py:235 - Batch request item event-3-K·∫ø to√°n t√† succeeded. Event ID: bgfdbdecaf6tmnvn26btke3774
2025-04-20 01:45:31,364 - INFO - app.py:235 - Batch request item event-4-Kinh doanh succeeded. Event ID: 23q67nh4b0027sr1fpt62i1r7g
2025-04-20 01:45:31,364 - INFO - app.py:351 - Batch executed. Callback results: Added=4, Errors=0
2025-04-20 01:45:31,364 - INFO - app.py:362 - Sync done: user=fff@st.uel.edu.vn, week=16/06/2025-22/06/2025, Added=4, Skipped=0, Errors=0, Time=1.16s
2025-04-20 01:45:31,364 - INFO - _internal.py:97 - 127.0.0.1 - - [20/Apr/2025 01:45:31] "POST /sync_from_extension HTTP/1.1" 200 -
2025-04-20 01:45:32,381 - INFO - app.py:243 - Request /sync_from_extension (Batch Optimized, Color by Subject)
2025-04-20 01:45:32,381 - DEBUG - app.py:253 - Sync Data: user='fff@st.uel.edu.vn', date='T·ª´ ng√†y 23/06/2025 ƒë·∫øn ng√†y 29/06/2025', html=Yes
2025-04-20 01:45:32,381 - INFO - app.py:259 - Processing sync for user: fff@st.uel.edu.vn
2025-04-20 01:45:32,386 - INFO - app.py:66 - Service built from token OK.
2025-04-20 01:45:32,386 - INFO - app.py:74 - Starting schedule extraction (Flexible Parsing).
2025-04-20 01:45:32,386 - INFO - app.py:85 - Parsed week: 23/06/2025 - 29/06/2025
2025-04-20 01:45:32,387 - DEBUG - app.py:99 - Headers: ['PH√íNG', 'TH·ª® 2', 'TH·ª® 3', 'TH·ª® 4', 'TH·ª® 5', 'TH·ª® 6', 'TH·ª® 7', 'CH·ª¶ NH·∫¨T']
2025-04-20 01:45:32,387 - INFO - app.py:114 - Header: RoomIdx=0, DayIndices={'TH·ª® 2': 1, 'TH·ª® 3': 2, 'TH·ª® 4': 3, 'TH·ª® 5': 4, 'TH·ª® 6': 5, 'TH·ª® 7': 6, 'CH·ª¶ NH·∫¨T': 7}
2025-04-20 01:45:32,388 - DEBUG - app.py:125 - Row 2: Room='B1.305'
2025-04-20 01:45:32,388 - DEBUG - app.py:142 - Cell(2,2), Block 1: Lines=['K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', '7h00 -> 9h30', 'Ti·∫øt 1-3', 'GV:']
2025-04-20 01:45:32,388 - DEBUG - app.py:160 - Time match: Raw='7h00 -> 9h30'
2025-04-20 01:45:32,388 - DEBUG - app.py:164 - Periods regex: '1-3'
2025-04-20 01:45:32,388 - DEBUG - app.py:193 - Final DateTime: Start=2025-06-24T07:00:00, End=2025-06-24T09:30:00
2025-04-20 01:45:32,388 - DEBUG - app.py:199 - Prepared: Sub='K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', P='1-3'
2025-04-20 01:45:32,389 - DEBUG - app.py:142 - Cell(2,2), Block 2: Lines=['Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]', '12h30 -> 16h30', 'Ti·∫øt 7-10.5', 'GV:']
2025-04-20 01:45:32,389 - DEBUG - app.py:160 - Time match: Raw='12h30 -> 16h30'
2025-04-20 01:45:32,389 - DEBUG - app.py:164 - Periods regex: '7-10.5'
2025-04-20 01:45:32,389 - DEBUG - app.py:193 - Final DateTime: Start=2025-06-24T12:30:00, End=2025-06-24T16:30:00
2025-04-20 01:45:32,389 - DEBUG - app.py:199 - Prepared: Sub='Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]', P='7-10.5'
2025-04-20 01:45:32,389 - DEBUG - app.py:142 - Cell(2,4), Block 1: Lines=['K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', '7h00 -> 9h30', 'Ti·∫øt 1-3', 'GV:']
2025-04-20 01:45:32,389 - DEBUG - app.py:160 - Time match: Raw='7h00 -> 9h30'
2025-04-20 01:45:32,389 - DEBUG - app.py:164 - Periods regex: '1-3'
2025-04-20 01:45:32,390 - DEBUG - app.py:193 - Final DateTime: Start=2025-06-26T07:00:00, End=2025-06-26T09:30:00
2025-04-20 01:45:32,390 - DEBUG - app.py:199 - Prepared: Sub='K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', P='1-3'
2025-04-20 01:45:32,390 - DEBUG - app.py:142 - Cell(2,4), Block 2: Lines=['Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]', '12h30 -> 16h30', 'Ti·∫øt 7-10.5', 'GV:']
2025-04-20 01:45:32,390 - DEBUG - app.py:160 - Time match: Raw='12h30 -> 16h30'
2025-04-20 01:45:32,390 - DEBUG - app.py:164 - Periods regex: '7-10.5'
2025-04-20 01:45:32,390 - DEBUG - app.py:193 - Final DateTime: Start=2025-06-26T12:30:00, End=2025-06-26T16:30:00
2025-04-20 01:45:32,390 - DEBUG - app.py:199 - Prepared: Sub='Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]', P='7-10.5'
2025-04-20 01:45:32,390 - INFO - app.py:205 - Extraction done. Found 4 events.
2025-04-20 01:45:32,391 - DEBUG - app.py:206 - --- Final Extracted Schedule List (No Color) ---
[{'date': '24/06/2025',
  'day_name': 'TH·ª® 3',
  'description_extra': '',
  'end_datetime': '2025-06-24T09:30:00',
  'location': '',
  'periods': '1-3',
  'room': 'B1.305',
  'start_datetime': '2025-06-24T07:00:00',
  'subject': 'K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]',
  'teacher': '',
  'time_range': '7h00 -> 9h30'},
 {'date': '24/06/2025',
  'day_name': 'TH·ª® 3',
  'description_extra': '',
  'end_datetime': '2025-06-24T16:30:00',
  'location': '',
  'periods': '7-10.5',
  'room': 'B1.305',
  'start_datetime': '2025-06-24T12:30:00',
  'subject': 'Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]',
  'teacher': '',
  'time_range': '12h30 -> 16h30'},
 {'date': '26/06/2025',
  'day_name': 'TH·ª® 5',
  'description_extra': '',
  'end_datetime': '2025-06-26T09:30:00',
  'location': '',
  'periods': '1-3',
  'room': 'B1.305',
  'start_datetime': '2025-06-26T07:00:00',
  'subject': 'K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]',
  'teacher': '',
  'time_range': '7h00 -> 9h30'},
 {'date': '26/06/2025',
  'day_name': 'TH·ª® 5',
  'description_extra': '',
  'end_datetime': '2025-06-26T16:30:00',
  'location': '',
  'periods': '7-10.5',
  'room': 'B1.305',
  'start_datetime': '2025-06-26T12:30:00',
  'subject': 'Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]',
  'teacher': '',
  'time_range': '12h30 -> 16h30'}]
--- End List ---
2025-04-20 01:45:32,391 - INFO - app.py:273 - Extracted 4 events for 23/06/2025-29/06/2025
2025-04-20 01:45:32,391 - INFO - app.py:295 - Fetching existing events: 2025-06-22T17:00:00Z to 2025-06-29T16:59:59Z
2025-04-20 01:45:32,397 - DEBUG - discovery.py:1256 - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/primary/events?timeMin=2025-06-22T17%3A00%3A00Z&timeMax=2025-06-29T16%3A59%3A59Z&singleEvents=true&maxResults=250&alt=json
2025-04-20 01:45:32,876 - INFO - app.py:310 - Found 0 existing events details in Google Calendar for the week.
2025-04-20 01:45:32,877 - INFO - app.py:326 - Processing 4 extracted events against 0 existing ones...
2025-04-20 01:45:32,877 - DEBUG - app.py:336 - Event 1 ('K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]' Color: 1) marked for BATCH insert.
2025-04-20 01:45:32,882 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:32,882 - DEBUG - app.py:336 - Event 2 ('Qu·∫£n tr·ªã t√†i ch√≠nh (E) [3]' Color: 2) marked for BATCH insert.
2025-04-20 01:45:32,887 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:32,887 - DEBUG - app.py:336 - Event 3 ('K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]' Color: 1) marked for BATCH insert.
2025-04-20 01:45:32,892 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:32,892 - DEBUG - app.py:336 - Event 4 ('Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]' Color: 3) marked for BATCH insert.
2025-04-20 01:45:32,896 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:32,896 - INFO - app.py:346 - Executing batch request to insert 4 events...
2025-04-20 01:45:33,582 - INFO - app.py:235 - Batch request item event-1-K·∫ø to√°n t√† succeeded. Event ID: kam82tbc774fd6ln9tp7kl5rho
2025-04-20 01:45:33,582 - INFO - app.py:235 - Batch request item event-2-Qu·∫£n tr·ªã t succeeded. Event ID: ldc8kmrif7j0mvdgegnsr9bvk8
2025-04-20 01:45:33,582 - INFO - app.py:235 - Batch request item event-3-K·∫ø to√°n t√† succeeded. Event ID: pc006j457i5g7a14cmg7jef55o
2025-04-20 01:45:33,583 - INFO - app.py:235 - Batch request item event-4-Kinh doanh succeeded. Event ID: ogflpa08320duohlnr4ie1vbqc
2025-04-20 01:45:33,583 - INFO - app.py:351 - Batch executed. Callback results: Added=4, Errors=0
2025-04-20 01:45:33,583 - INFO - app.py:362 - Sync done: user=fff@st.uel.edu.vn, week=23/06/2025-29/06/2025, Added=4, Skipped=0, Errors=0, Time=1.20s
2025-04-20 01:45:33,584 - INFO - _internal.py:97 - 127.0.0.1 - - [20/Apr/2025 01:45:33] "POST /sync_from_extension HTTP/1.1" 200 -
2025-04-20 01:45:34,598 - INFO - app.py:243 - Request /sync_from_extension (Batch Optimized, Color by Subject)
2025-04-20 01:45:34,598 - DEBUG - app.py:253 - Sync Data: user='fff@st.uel.edu.vn', date='T·ª´ ng√†y 30/06/2025 ƒë·∫øn ng√†y 06/07/2025', html=Yes
2025-04-20 01:45:34,598 - INFO - app.py:259 - Processing sync for user: fff@st.uel.edu.vn
2025-04-20 01:45:34,603 - INFO - app.py:66 - Service built from token OK.
2025-04-20 01:45:34,603 - INFO - app.py:74 - Starting schedule extraction (Flexible Parsing).
2025-04-20 01:45:34,603 - INFO - app.py:85 - Parsed week: 30/06/2025 - 06/07/2025
2025-04-20 01:45:34,605 - DEBUG - app.py:99 - Headers: ['PH√íNG', 'TH·ª® 2', 'TH·ª® 3', 'TH·ª® 4', 'TH·ª® 5', 'TH·ª® 6', 'TH·ª® 7', 'CH·ª¶ NH·∫¨T']
2025-04-20 01:45:34,605 - INFO - app.py:114 - Header: RoomIdx=0, DayIndices={'TH·ª® 2': 1, 'TH·ª® 3': 2, 'TH·ª® 4': 3, 'TH·ª® 5': 4, 'TH·ª® 6': 5, 'TH·ª® 7': 6, 'CH·ª¶ NH·∫¨T': 7}
2025-04-20 01:45:34,605 - DEBUG - app.py:125 - Row 2: Room='B1.305'
2025-04-20 01:45:34,605 - DEBUG - app.py:142 - Cell(2,2), Block 1: Lines=['K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', '7h00 -> 9h30', 'Ti·∫øt 1-3', 'GV:']
2025-04-20 01:45:34,605 - DEBUG - app.py:160 - Time match: Raw='7h00 -> 9h30'
2025-04-20 01:45:34,605 - DEBUG - app.py:164 - Periods regex: '1-3'
2025-04-20 01:45:34,605 - DEBUG - app.py:193 - Final DateTime: Start=2025-07-01T07:00:00, End=2025-07-01T09:30:00
2025-04-20 01:45:34,606 - DEBUG - app.py:199 - Prepared: Sub='K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]', P='1-3'
2025-04-20 01:45:34,606 - DEBUG - app.py:142 - Cell(2,4), Block 1: Lines=['Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]', '12h30 -> 16h30', 'Ti·∫øt 7-10.5', 'GV:']
2025-04-20 01:45:34,606 - DEBUG - app.py:160 - Time match: Raw='12h30 -> 16h30'
2025-04-20 01:45:34,606 - DEBUG - app.py:164 - Periods regex: '7-10.5'
2025-04-20 01:45:34,606 - DEBUG - app.py:193 - Final DateTime: Start=2025-07-03T12:30:00, End=2025-07-03T16:30:00
2025-04-20 01:45:34,606 - DEBUG - app.py:199 - Prepared: Sub='Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]', P='7-10.5'
2025-04-20 01:45:34,607 - INFO - app.py:205 - Extraction done. Found 2 events.
2025-04-20 01:45:34,607 - DEBUG - app.py:206 - --- Final Extracted Schedule List (No Color) ---
[{'date': '01/07/2025',
  'day_name': 'TH·ª® 3',
  'description_extra': '',
  'end_datetime': '2025-07-01T09:30:00',
  'location': '',
  'periods': '1-3',
  'room': 'B1.305',
  'start_datetime': '2025-07-01T07:00:00',
  'subject': 'K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]',
  'teacher': '',
  'time_range': '7h00 -> 9h30'},
 {'date': '03/07/2025',
  'day_name': 'TH·ª® 5',
  'description_extra': '',
  'end_datetime': '2025-07-03T16:30:00',
  'location': '',
  'periods': '7-10.5',
  'room': 'B1.305',
  'start_datetime': '2025-07-03T12:30:00',
  'subject': 'Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]',
  'teacher': '',
  'time_range': '12h30 -> 16h30'}]
--- End List ---
2025-04-20 01:45:34,607 - INFO - app.py:273 - Extracted 2 events for 30/06/2025-06/07/2025
2025-04-20 01:45:34,607 - INFO - app.py:295 - Fetching existing events: 2025-06-29T17:00:00Z to 2025-07-06T16:59:59Z
2025-04-20 01:45:34,613 - DEBUG - discovery.py:1256 - URL being requested: GET https://www.googleapis.com/calendar/v3/calendars/primary/events?timeMin=2025-06-29T17%3A00%3A00Z&timeMax=2025-07-06T16%3A59%3A59Z&singleEvents=true&maxResults=250&alt=json
2025-04-20 01:45:35,311 - INFO - app.py:310 - Found 0 existing events details in Google Calendar for the week.
2025-04-20 01:45:35,311 - INFO - app.py:326 - Processing 2 extracted events against 0 existing ones...
2025-04-20 01:45:35,312 - DEBUG - app.py:336 - Event 1 ('K·∫ø to√°n t√†i ch√≠nh 2 (CFAB) [4]' Color: 1) marked for BATCH insert.
2025-04-20 01:45:35,319 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:35,319 - DEBUG - app.py:336 - Event 2 ('Kinh doanh-c√¥ng ngh·ªá v√† t√†i ch√≠nh - BTF 1 (CFAB) [3]' Color: 2) marked for BATCH insert.
2025-04-20 01:45:35,325 - DEBUG - discovery.py:1256 - URL being requested: POST https://www.googleapis.com/calendar/v3/calendars/primary/events?alt=json
2025-04-20 01:45:35,325 - INFO - app.py:346 - Executing batch request to insert 2 events...
2025-04-20 01:45:35,939 - INFO - app.py:235 - Batch request item event-1-K·∫ø to√°n t√† succeeded. Event ID: 6o4diio9i5ilt0kp02a42tg128
2025-04-20 01:45:35,940 - INFO - app.py:235 - Batch request item event-2-Kinh doanh succeeded. Event ID: hrnoqmgnq5c14akamtrbho9o88
2025-04-20 01:45:35,940 - INFO - app.py:351 - Batch executed. Callback results: Added=2, Errors=0
2025-04-20 01:45:35,940 - INFO - app.py:362 - Sync done: user=fff@st.uel.edu.vn, week=30/06/2025-06/07/2025, Added=2, Skipped=0, Errors=0, Time=1.34s
2025-04-20 01:45:35,941 - INFO - _internal.py:97 - 127.0.0.1 - - [20/Apr/2025 01:45:35] "POST /sync_from_extension HTTP/1.1" 200 -
2025-04-20 01:45:36,957 - INFO - app.py:243 - Request /sync_from_extension (Batch Optimized, Color by Subject)
2025-04-20 01:45:36,957 - DEBUG - app.py:253 - Sync Data: user='fff@st.uel.edu.vn', date='T·ª´ ng√†y 07/07/2025 ƒë·∫øn ng√†y 13/07/2025', html=Yes
2025-04-20 01:45:36,957 - INFO - app.py:259 - Processing sync for user: fff@st.uel.edu.vn
2025-04-20 01:45:36,959 - INFO - app.py:66 - Service built from token OK.
2025-04-20 01:45:36,959 - INFO - app.py:74 - Starting schedule extraction (Flexible Parsing).
2025-04-20 01:45:36,959 - INFO - app.py:85 - Parsed week: 07/07/2025 - 13/07/2025
2025-04-20 01:45:36,963 - INFO - app.py:273 - Extracted 0 events for 07/07/2025-13/07/2025
2025-04-20 01:45:36,963 - INFO - _internal.py:97 - 127.0.0.1 - - [20/Apr/2025 01:45:36] "POST /sync_from_extension HTTP/1.1" 200 -
2025-04-20 01:45:37,981 - INFO - app.py:243 - Request /sync_from_extension (Batch Optimized, Color by Subject)
2025-04-20 01:45:37,982 - DEBUG - app.py:253 - Sync Data: user='fff@st.uel.edu.vn', date='T·ª´ ng√†y 14/07/2025 ƒë·∫øn ng√†y 20/07/2025', html=Yes
2025-04-20 01:45:37,982 - INFO - app.py:259 - Processing sync for user: fff@st.uel.edu.vn
2025-04-20 01:45:37,984 - INFO - app.py:66 - Service built from token OK.
2025-04-20 01:45:37,984 - INFO - app.py:74 - Starting schedule extraction (Flexible Parsing).
2025-04-20 01:45:37,984 - INFO - app.py:85 - Parsed week: 14/07/2025 - 20/07/2025
2025-04-20 01:45:37,985 - INFO - app.py:273 - Extracted 0 events for 14/07/2025-20/07/2025
2025-04-20 01:45:37,985 - INFO - _internal.py:97 - 127.0.0.1 - - [20/Apr/2025 01:45:37] "POST /sync_from_extension HTTP/1.1" 200 -
2025-04-20 01:45:38,999 - INFO - app.py:243 - Request /sync_from_extension (Batch Optimized, Color by Subject)
2025-04-20 01:45:39,000 - DEBUG - app.py:253 - Sync Data: user='fff@st.uel.edu.vn', date='T·ª´ ng√†y 21/07/2025 ƒë·∫øn ng√†y 27/07/2025', html=Yes
2025-04-20 01:45:39,000 - INFO - app.py:259 - Processing sync for user: fff@st.uel.edu.vn
2025-04-20 01:45:39,002 - INFO - app.py:66 - Service built from token OK.
2025-04-20 01:45:39,002 - INFO - app.py:74 - Starting schedule extraction (Flexible Parsing).
2025-04-20 01:45:39,003 - INFO - app.py:85 - Parsed week: 21/07/2025 - 27/07/2025
2025-04-20 01:45:39,003 - INFO - app.py:273 - Extracted 0 events for 21/07/2025-27/07/2025
2025-04-20 01:45:39,004 - INFO - _internal.py:97 - 127.0.0.1 - - [20/Apr/2025 01:45:39] "POST /sync_from_extension HTTP/1.1" 200 -
2025-04-20 01:45:40,023 - INFO - app.py:243 - Request /sync_from_extension (Batch Optimized, Color by Subject)
2025-04-20 01:45:40,024 - DEBUG - app.py:253 - Sync Data: user='fff@st.uel.edu.vn', date='T·ª´ ng√†y 28/07/2025 ƒë·∫øn ng√†y 03/08/2025', html=Yes
2025-04-20 01:45:40,024 - INFO - app.py:259 - Processing sync for user: fff@st.uel.edu.vn
2025-04-20 01:45:40,027 - INFO - app.py:66 - Service built from token OK.
2025-04-20 01:45:40,027 - INFO - app.py:74 - Starting schedule extraction (Flexible Parsing).
2025-04-20 01:45:40,027 - INFO - app.py:85 - Parsed week: 28/07/2025 - 03/08/2025
2025-04-20 01:45:40,028 - INFO - app.py:273 - Extracted 0 events for 28/07/2025-03/08/2025
2025-04-20 01:45:40,028 - INFO - _internal.py:97 - 127.0.0.1 - - [20/Apr/2025 01:45:40] "POST /sync_from_extension HTTP/1.1" 200 -
2025-04-20 01:45:41,048 - INFO - app.py:243 - Request /sync_from_extension (Batch Optimized, Color by Subject)
2025-04-20 01:45:41,048 - DEBUG - app.py:253 - Sync Data: user='fff@st.uel.edu.vn', date='T·ª´ ng√†y 04/08/2025 ƒë·∫øn ng√†y 10/08/2025', html=Yes
2025-04-20 01:45:41,048 - INFO - app.py:259 - Processing sync for user: fff@st.uel.edu.vn
2025-04-20 01:45:41,050 - INFO - app.py:66 - Service built from token OK.
2025-04-20 01:45:41,050 - INFO - app.py:74 - Starting schedule extraction (Flexible Parsing).
2025-04-20 01:45:41,050 - INFO - app.py:85 - Parsed week: 04/08/2025 - 10/08/2025
2025-04-20 01:45:41,051 - INFO - app.py:273 - Extracted 0 events for 04/08/2025-10/08/2025
2025-04-20 01:45:41,052 - INFO - _internal.py:97 - 127.0.0.1 - - [20/Apr/2025 01:45:41] "POST /sync_from_extension HTTP/1.1" 200 -
2025-04-20 01:45:42,070 - INFO - app.py:243 - Request /sync_from_extension (Batch Optimized, Color by Subject)
2025-04-20 01:45:42,070 - DEBUG - app.py:253 - Sync Data: user='fff@st.uel.edu.vn', date='T·ª´ ng√†y 11/08/2025 ƒë·∫øn ng√†y 17/08/2025', html=Yes
2025-04-20 01:45:42,070 - INFO - app.py:259 - Processing sync for user: fff@st.uel.edu.vn
2025-04-20 01:45:42,072 - INFO - app.py:66 - Service built from token OK.
2025-04-20 01:45:42,072 - INFO - app.py:74 - Starting schedule extraction (Flexible Parsing).
2025-04-20 01:45:42,072 - INFO - app.py:85 - Parsed week: 11/08/2025 - 17/08/2025
2025-04-20 01:45:42,073 - INFO - app.py:273 - Extracted 0 events for 11/08/2025-17/08/2025
2025-04-20 01:45:42,073 - INFO - _internal.py:97 - 127.0.0.1 - - [20/Apr/2025 01:45:42] "POST /sync_from_extension HTTP/1.1" 200 -
